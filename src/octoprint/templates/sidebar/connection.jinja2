<form>
    <label data-bind="css: {disabled: !isErrorOrClosed()}, enable: isErrorOrClosed()">{{ _('Connection Profile') }}</label>
    <select class="input-block-level" data-test-id="connection-ports" data-bind="options: availableConnectionProfiles, optionsText: 'name', value: selectedConnectionProfile, optionsCaption: 'New...', css: {disabled: !isErrorOrClosed()}, enable: isErrorOrClosed()"></select>
    <label class="checkbox">
        <input type="checkbox" data-bind="checked: adjustConnectionParameters"> {{ _('Adjust connection parameters') }}
    </label>
    <div style="display: none" data-bind="visible: adjustConnectionParameters">
        <hr style="margin: 0">

        <label data-bind="css: {disabled: !isErrorOrClosed()}, enable: isErrorOrClosed()">{{ _('Printer Profile') }}</label>
        <select class="input-block-level" data-test-id="connection-printer-profiles" data-bind="options: availablePrinterProfiles, optionsText: 'name', value: selectedPrinter, css: {disabled: !isErrorOrClosed()}, enable: isErrorOrClosed()"></select>

        <hr style="margin: 0">

        <label data-bind="css: {disabled: !isErrorOrClosed()}, enable: isErrorOrClosed()">{{ _('Protocol') }}</label>
        <select class="input-block-level" data-test-id="connection-protocols" data-bind="options: availableProtocols, optionsText: 'name', value: selectedProtocol, css: {disabled: !isErrorOrClosed()}, enable: isErrorOrClosed()"></select>
        <!-- ko foreach: protocolParameters -->
        <!-- ko if: !advanced -->
        <!-- ko template: { name: 'parameter_template_form_' + $data.type, data: $data } --><!-- /ko -->
        <!-- /ko -->
        <!-- /ko -->
        <!-- ko if: advancedProtocolParameters -->
        <small class="text-block text-right"><a href="javascript:void(0)" data-bind="click: showAdvancedProtocolOptions">{{ _('Advanced...') }}</a></small>
        <!-- /ko -->

        <hr style="margin: 0">

        <label data-bind="css: {disabled: !isErrorOrClosed()}, enable: isErrorOrClosed()">{{ _('Transport') }}</label>
        <select class="input-block-level" data-test-id="connection-transports" data-bind="options: availableTransports, optionsText: 'name', value: selectedTransport, css: {disabled: !isErrorOrClosed()}, enable: isErrorOrClosed()"></select>
        <!-- ko foreach: transportParameters -->
        <!-- ko if: !advanced -->
        <!-- ko template: { name: 'parameter_template_form_' + $data.type, data: $data } --><!-- /ko -->
        <!-- /ko -->
        <!-- /ko -->
        <!-- ko if: advancedTransportParameters -->
        <small class="text-block text-right"><a href="javascript:void(0)" data-bind="click: showAdvancedTransportOptions">{{ _('Advanced...') }}</a></small>
        <!-- /ko -->

        <hr style="margin: 0">
    </div>
    <label class="checkbox">
        <input type="checkbox" id="connection_autoconnect" data-bind="checked: settings.serial_autoconnect, css: {disabled: !isErrorOrClosed()}, enable: isErrorOrClosed()"> {{ _('Auto-connect on server startup') }}
    </label>
</form>

<button class="btn btn-block" id="printer_connect_and_save" data-bind="click: function() { connect(true) }, visible: isErrorOrClosed() && adjustConnectionParameters()">{{ _('Save & Connect') }}</button>
<button class="btn btn-primary btn-block" id="printer_connect" data-test-id="connection-connect" data-bind="click: function() { connect() }, text: buttonText">{{ _('Connect') }}</button>
